# Cloudflare Worker configuration for Legal Exhibits Toolkit
name = "legal-exhibits-api"
main = "src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Cloudflare account configuration
account_id = "1a25a792e801e687b9fe4932030cf6a6"  # The HOLE Foundation

# Custom domain for Cloudflare Access protection
routes = [
  { pattern = "legal-exhibits.theholetruth.org", custom_domain = true }
]

# R2 bucket for storing PDFs
[[r2_buckets]]
binding = "PDF_BUCKET"
bucket_name = "legal-exhibits"
# preview_bucket_name = "legal-exhibits-preview"  # For local dev

# Queue for async processing jobs (optional)
# [[queues.producers]]
# binding = "PDF_QUEUE"
# queue = "pdf-processing"

# KV namespace for job status tracking
[[kv_namespaces]]
binding = "JOB_STATUS"
id = "4ab32cdc37ab43f5bc8e8fe62df88d10"

# Environment variables
[vars]
ENVIRONMENT = "development"
MAX_FILE_SIZE_MB = "50"

# For processing server webhook (when using external processor)
# PROCESSOR_WEBHOOK_URL = "https://your-processor.example.com/process"
# PROCESSOR_API_KEY = "your-secret-key"

# Development settings
[dev]
port = 8787
local_protocol = "http"

# Production overrides
# [env.production]
# vars = { ENVIRONMENT = "production" }
